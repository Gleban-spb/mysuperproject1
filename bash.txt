шпаргалка по BASH
Ср 28 сен 2022 21:53:04 MSK
/home/user/myproject/mysuperproject1

Лекции - Работа в командной строке BASH (2020)
Уроки SHELL&BASH 2022
poweroff - выключение компьютера
pwd  - вывод домашней директории
ls - список файлов и папок
ls -l - подробный список файлов и папок
ll - подробный список файлов и папок
ls -la - подробный список файлов и папок вместе со скрытыми и ситемными
man ls - инструкция по работе с ls
whoami - вывод имени текущего пользователя
sudo  - запуск программы от лица суперпользователя (SuperUserDo)
history - прсмотр введеных ранеекоманд (Ctrl+R  - поиск внутри истории)
history | tail 20 - просмотр последних 20 команд
!номер - вывод в командную стоку команды из history (например !566)
echo 'HISTSIZE=50000' >>.zshrc  - изменние размера history до 50000
history -c  - очистка файла истории

clear - очистка окна терминала  (Ctrl+L)
cat - просмотр содержимого файла, можно склеивать файлы
cd ~ - переход в home директорию  
realpath - упрощение пути к файлу
more - постраничный просмотр файла работает поиск
less - постраничный просмотр файла работает в обе стороны
head - просмотр начала файла
tail - просмотр конца файла

Директории
pwd - вывод имени текущей диектории
basename
dirname
mkdir - создать папку (можно создать несколько папок перечислив их mkdir test test1 test2 mkdir -p test/test1  - создать папку test c подпапкой test1)

mkdir test4 && mkdir test4/test5 && cd test4 && echo Hello >test.txt

rmdir - удалить пустую папку
rm -r - удалить папку со всем содержимым

touch - изменитель дат файла. Самый быстрый способ создания пустого файла - touch test.txt
cp - копировать файл (много опций)
rm -  удалить файл
ls -s   - создать софт-линк на файл, или директорию (ярлык)
ls      - создать хард-линк (еще одно имя файла - К ДИРЕКТОРИИ НЕПРИМЕНИМО!!!)
cp -R - копировать папку с подпапками
mv - переименовать файл или папку

VALUE=25 - 25 в переменную VALUE
export VALUE=25 - импорт 25 в глобальную переменную VALUE в текущем терминале
$VALUE - вывод переменной VALUE 
printenv - вывод глобальных переменных
export PATH=$PATH:/usr/scripts   - добавление в переменую PATH папку /usr/scripts

echo 'VALUE=5' >>.zshrc - добавление переменной VALUE в конфигурационный файл .zshrc
source - перезапуск конфигурации в рамках текущего терминала (. заменяет source, но нужно прописывать полный путь . ./.zshrc)

Комбинирование команд
cd docker ; ls  -  переход в каталог docker и вывод содержимого 
cd docker && ls -  переход в каталог docker и вывод содержимого, если первая команда выполнена без ошибок (&& - логическое И)
cd docker || ls -  переход в каталог docker и не вывод содержимого, если первая команда выполнена без ошибок (|| - логическое ИЛИ)

mc - аналог nc
nano - текстовый редактор
mcedit - текстовый редактор
vim - текстовый редактор
cut - извлечение колонок из файла
paste - добавление колонок в файл
tr - преобразоваине символов
sort - сорировка
uniq - оставить только уникальные значения
tee - копирование файла и печать
grep - поиск по регуляному выражению
egrep - поиск по сложным регуляноым выражениям 
ls -l |egrep "[0-9]{1,}" вывод строк с числами
egrep "alias" .zshrc  - поиск предустановленных алиасов 

sed 's/\  \{1,\}/:/g'  ls_output.txt - замена нескольких пробелов одним
cat  ls_output.txt | awk '$1=$1' >ls_output_2.txt - замена нескольких пробелов одним
cat unic_numbers.txt|tr '\n' '_'   - замена переводов строк пробелами
tr ' ' '\n'   - замена пробелов переводами строк

Поиск файлов
which -поиск исполняемых файлов
type  -поиск исполняемых файлов и их алиасов
whereis - ищет в стандарных директориях 

locate - поиск в индексе
find  - поиск файлов - медленный куча опций
find . -name "info" 2>/dev/null  - ишем в корневой директории файл info с удалением сообщений об ошибках
xargs   - модификтор после find

Метаинформация о файлах и папках
stat
file
wc  - оказывает количество строк слов символов в файле
du   - размер файла или директории
crown изменение владельца файла или папки
chgrp изменение группы владельцев 
chmod изменение прав доступа +-r +-w +-x \добавить-удалить чтение, запись, выполнение\

Пользователи и группы
id - список пользователей с идетификаторами
printenv - переменные текущего пользователя
whoami  - имя текущего пользователя
who  - имя текущего пользователя
users - имя текущего пользоватля
useradd - добавление нового пользователя (создается в заблокированном состоянии - разблокировка устанвка пароля командой passwd)
userdel
usrmod
passwd
chfn
chsh

groups  - группы
groupadd
groupdel
groupmod




df -h - просмтр размера файловой системы
du -h  - просмотр размера папок
wc имя файла - вывод информации о содержимом файла - количество строк, слов, символов
>    - вывод в файл
>>   - дописывает в конец фала
1>   - вывод в файл
2>   - вывод ошибок в файл
|    - конвеер - передача выходных данных из одной программы на вход другой
<    - передача данных на вход программы

Сети
host
ping
traceroute

Горячие клавиши для клавиатуры Kali Linux

    Онлайн-справка: F1
    Левое меню курсора: F10
    Открыть окно: Alt + F1
    Открыть командное окно: Alt + F2
    Закрыть окно: Alt + F4
    Окно перемещения: Alt + F7
    Окно изменения размера: Alt + F8
    Переключить режим максимизации: Alt + F10

Сочетания клавиш терминала

Ctrl + D 	Закрыть окно терминала
Ctrl + C 	Отменить текущую выполняющуюся команду
Ctrl + L 	Очистить терминал
Ctrl + + 	Приблизить
Ctrl + – 	Уменьшить
Ctrl + A 	Переместить курсор в начало строки
Ctrl + B 	Переместить курсор на один символ назад
Ctrl + E 	Переместить курсор в конец строки
Ctrl + F 	Переместить курсор на один символ вперед

Редактирование текста

    Новое: Ctrl + N
    Вырезать: Ctrl + X
    Копировать: Ctrl + C
    Вставить: Ctrl + P
    Отменить: Ctrl + Z
    Сохранить: Ctrl + S
    Выйти: Ctrl + Q

Скриншоты

    Скриншот: PrtSc
    Снимок экрана окна: Alt + PrtSc
    Скриншот области: Shift + PrtSc
    Снимок экрана в буфер обмена: Ctrl + PrtSc
    Скриншот окна в буфер обмена: Ctrl + Alt + PrtSc
    Снимок экрана с области в буфер обмена: Shift + Ctrl + PrtSc
    Записать короткий скринкаст: Shift + Ctrl + Alt + R

Работа с окнами

    Переместить окно в одну рабочую область влево: Shift + Ctrl + Alt + Left
    Переместить окно в одно рабочее пространство вправо: Shift + Ctrl + Alt + Right
    Переместить окно в одно рабочее пространство вверх: Shift + Ctrl + Alt + Up
    Переместить окно на одну рабочую область вниз: Shift + Ctrl + Alt + Page Down
    Минимизирует все окна: Ctrl + Alt + D
    Активируйте меню окна: Alt + Space



grep  - поиск внутри вывода 
например :
ls -l |grep "git"
-rw-r--r-- 1 user user  492 сен 28 02:16 git.txt


Регулярные выражения
$ grep поисковый_запрос_regex расположение_файла

Изучим некоторые специальные символы, известные как метасимволы. Они помогают создавать более сложные поисковые выражения:
. 	будет соответствовать любому символу;
[ ] 	будет соответствовать диапазону символов;
[^ ] 	будет соответствовать всем символам, кроме указанных в фигурных скобках;
* 	будет соответствовать любому количеству символов, предшествующих звездочке, в том числе нулю;
+ 	будет соответствовать одному или нескольким из стоящих перед ним выражений;
? 	будет соответствовать нулю или одному из стоящих перед ним выражений;
{n} 	будет соответствовать 'n' повторениям предшествующих выражений;
{n,} 	будет соответствовать не менее 'n' повторениям предшествующих выражений;
{n m} 	будет соответствовать не менее 'n' и не более 'm' повторениям предшествующих выражений;
{,m} 	будет соответствовать не более или равному 'm' повторениям предшествующих выражений;
	является escape-символом (символом экранирования), используемым, когда нужно включить один из метасимволов.

sudo -i  - включить root
nmap -sn -T4 192.168.0.0-255 -oN home.txt - показать все включенные машины внутри сети в файл
grep -E -o "([0-9]{1,3}[\.]){3}[0-9]{1,3}" home.txt >ip.txt - выделение ip адресов из файла home.txt в файл ip.txt
nmap -T5 -p0-65535 -iL ip.txt -oN home_big.csv - просканровать все порты на всех включенных в сеть машинах из файла ip.txt в файл home_big.csv
одной командой :
nmap -sn -T4 192.168.0.0-255 -oN home.txt; grep -E -o "([0-9]{1,3}[\.]){3}[0-9]{1,3}" home.txt >ip.txt; nmap -T5 -p0-65535 -iL ip.txt -oN home_big.csv
exit - выйти из root 

#Монтирование общих папок с windows на даче:
sudo mount //192.168.2.35/work/   ./mnt/work -t cifs -o user=smb,password=smb,rw,iocharset=utf8,file_mode=0777,dir_mode=0777
sudo mount //192.168.2.35/video2/   ./mnt/video2 -t cifs -o user=smb,password=smb,rw,iocharset=utf8,file_mode=0777,dir_mode=0777

----------
#файлы примеров sh из книги KaliLinyx.Библия пентестера
#!/bin/bash
#Пингуем и получаем DNS-имена для IP-адресов, хранящихся в файле
#Запускаем из под root  (sudo -i)
#Выводим пользователю подсказку ввести имя файла и путь до него.
read -p "Enter the IP addresses file name / path:" FILE_PATH_NAME
function check_host(){
#Если значение IP-адреса не пусто
if [[ -n $IP_ADDRESS ]]
then
ping_cmd=$(nmap -sn $IP_ADDRESS| grep 'Host is up' | cut
-d '(' -f 1)
echo '------------------------------------------------'
if [[ -z $ping_cmd ]]
then
printf "$IP_ADDRESS is down\n"
else
printf "$IP_ADDRESS is up\n"
dns_name
fi
fi
}
function dns_name(){
dns_name=$(host $IP_ADDRESS)
printf "$dns_name\n"
}
#Проходим циклом по IP-адресам в файле
for ip in $(cat $FILE_PATH_NAME)
do
IP_ADDRESS=$ip
check_host
done
 4  
simpleping.sh
@@ -1,5 +1,7 @@
#!/bin/bash
#Пингуем хост с помощью Nmap
#Запускаем из под root  (sudo -i)
#bush simpleping.sh 192.168.2.35
#Пингуем хост с помощью Nmap 
### Глобальные переменные ###
#Сохраняем IP-адрес
IP_ADDRESS=$1
----------
java

#----------------
#Инструменты для рботы с сетями
ip addr show
ping google.com
#бескончно до сброса ctl+c
ping 192.168.2.35 -c 5 -a  -s 1400 #ASUS на даче, размер пакета 1400 5 запросов + пиканье из динамика
#64 bytes from 192.168.2.35: icmp_seq=1 ttl=128 time=5.32 ms
traceroute yandex.ru  #показывает путь         
mtr  yandex.ru #постоянно показывает путь к узлу 
#пришлось доустанавливать  
#sudo apt-get install mtr 
sudo tcpdump # выводит описание содержимого пакетов на сетевом интерфейсе - показывает все пакеты
sudo tcpdum not port 22#запуск на удаленной машине, иначе будет зацикливание с самим запросом
curl google.com -vvv #инструмент для передачи данных с сервера или на сервер. 
wireshark #бесплатный анализатор пакетов, используется для устранения неполадок в сети, анализа, разработки программного обеспечения и протоколов связи.
